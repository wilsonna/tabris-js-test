/*!
 * tabris.js 2015-02-27
 * 
 * Copyright (c) 2014, 2015 EclipseSource Inc.
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Tabris.js nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
!function(){var a={extend:function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a},pick:function(a,b){var c={};for(var d in a)-1!==b.indexOf(d)&&(c[d]=a[d]);return c},omit:function(a,b){var c={};for(var d in a)-1===b.indexOf(d)&&(c[d]=a[d]);return c},clone:function(a){var b={};for(var c in a)b[c]=a[c];return b},rename:function(a,b){var c={};for(var d in a)c[b[d]||d]=a[d];return c},invert:function(a){var b={};for(var c in a)b[a[c]]=c;return b},bind:function(a,b){return function(){return a.apply(b,arguments)}},extendPrototype:function(a,b){var c=function(){};return c.prototype=a.prototype,this.extend(new c,b,{"super":function(b){return a.prototype[b].apply(this,Array.prototype.slice.call(arguments,1))}})}};!function(){a.colorArrayToString=function(a){var b=a[0],c=a[1],d=a[2],e=3===a.length?1:Math.round(100*a[3]/255)/100;return"rgba("+b+", "+c+", "+d+", "+e+")"},a.colorStringToArray=function(a){if("transparent"===a)return[0,0,0,0];if(/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/.test(a))return[parseInt(RegExp.$1,16),parseInt(RegExp.$2,16),parseInt(RegExp.$3,16),255];if(/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/.test(a))return[17*parseInt(RegExp.$1,16),17*parseInt(RegExp.$2,16),17*parseInt(RegExp.$3,16),255];if(/^rgb\s*\(\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*\)$/.test(a))return[Math.max(0,Math.min(255,parseInt(RegExp.$1))),Math.max(0,Math.min(255,parseInt(RegExp.$2))),Math.max(0,Math.min(255,parseInt(RegExp.$3))),255];if(/^rgba\s*\(\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*,\s*([+\-]?([0-9]*\.)?[0-9]+)\s*\)$/.test(a))return[Math.max(0,Math.min(255,parseInt(RegExp.$1))),Math.max(0,Math.min(255,parseInt(RegExp.$2))),Math.max(0,Math.min(255,parseInt(RegExp.$3))),Math.round(255*Math.max(0,Math.min(1,parseFloat(RegExp.$4))))];if(a in b){var c=b[a];return[c[0],c[1],c[2],255]}throw new Error("invalid color: "+a)};var b={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]}}(),function(){a.fontStringToArray=function(a){var e=[[],0,!1,!1],f=a.split(/(?:\s|^)\d+px(?:\s|$)/);return d(2===f.length||1===f.length,"Invalid font syntax"),e[1]=parseInt(/(?:\s|^)(\d+)px(?:\s|$)/.exec(a)[1],10),b(e,f[0]),c(e,f[1]),e},a.fontArrayToString=function(a){return(a[3]?"italic ":"")+(a[2]?"bold ":"")+(a[1]+"px")+(a[0][0]?" ":"")+a[0].join(", ")};var b=function(a,b){var c=b.trim().split(/\s+/);d(c.length<=2,"Too many font styles"),c.forEach(function(b){switch(b.trim()){case"italic":d(a[3]===!1,"Invalid font variant"),a[3]=!0;break;case"bold":d(a[2]===!1,"Invalid font weight"),a[2]=!0;break;case"normal":case"":break;default:throw new Error("Unknown font property: "+b.trim())}})},c=function(a,b){(b?b.split(","):[]).forEach(function(b){var c=/(?:^\s*[^\"\']+\s*$)|(?:^\s*\"[^\"\']+\"\s*$)|(?:^\s*\'[^\"\']+\'\s*$)/.exec(b);d(c,"Invalid font family: "+b),a[0].push(/^\s*[\"\']?([^\"\']*)/.exec(b)[1].trim())})},d=function(a,b){if(!a)throw new Error(b)}}(),function(){function b(a){return null!=a?a:null}a.imageToArray=function(a){return[a.src,b(a.width),b(a.height),b(a.scale)]},a.imageFromArray=function(a){var b={src:a[0]};return a.length>1&&(b.width=a[1]),a.length>2&&(b.height=a[2]),a.length>3&&(b.scale=a[3]),b}}(),function(b){function c(a){var b={};for(var c in a){var d=a[c];b[c]="object"==typeof d?d:{},b[c].name||(b[c].name="string"==typeof d?d:c)}return b}function d(a){var b={};for(var c in a){var d=a[c].name;b[d]=c}return b}function e(b){var c=f[b];return c instanceof Object?a.clone(c):c}window.tabris=b.exports=a.extend(function(a){if(!tabris._proxies[a]&&!tabris[a])throw new Error("No native object with id or type "+a);var b=tabris[a]&&tabris[a]._type?tabris[a]._type:a;return b in tabris._proxies?tabris._proxies[b]:new tabris[a](b)},{_loadFunctions:[],_proxies:{},_ready:!1,load:function(a){tabris._ready?a.call():tabris._loadFunctions.push(a)},create:function(a,b){if(!tabris._nativeBridge)throw new Error("tabris.js not started");if(!(a in tabris))throw new Error("Unknown type "+a);return tabris[a].prototype.type!==a&&console.warn('"'+a+'" is deprecated, use "'+tabris[a].prototype.type+'"'),(new tabris[a])._create(b||{})},registerType:function(b,g){if(b in tabris)throw new Error("Type already registered: "+b);tabris[b]=function(){tabris.Proxy.apply(this,arguments)},g._listen&&!g._events&&(g._events=g._listen,delete g._listen);for(var h in f)tabris[b][h]=g[h]||e(h);tabris[b]._events=c(tabris[b]._events),tabris[b]._trigger=d(tabris[b]._events);var i=a.omit(g,Object.keys(f));i.type=b,i.constructor=tabris[b],tabris[b].prototype=a.extendPrototype(tabris.Proxy,i)},version:"0.9.2",_init:function(a){tabris.off(),tabris._client=a,tabris._nativeBridge=new tabris.NativeBridge(a);for(var b=0;b<tabris._loadFunctions.length;)tabris._loadFunctions[b++].call();tabris._ready=!0},_setEntryPoint:function(a){this._entryPoint=a},_notify:function(a,b,c){try{var d=tabris._proxies[a];if(d)try{d._trigger(b,c)}catch(e){console.error(e),console.log(e.stack)}tabris.trigger("flush")}catch(f){console.error(f),console.log(f.stack)}},_reset:function(){this._loadFunctions=[],this._proxies={}}});var f={_events:{},_initProperties:{},_type:null,_properties:{},_supportsChildren:!1}}("undefined"!=typeof module?module:{}),function(){tabris.NativeBridge=function(a){this._bridge=a,this._operations=[],this._currentOperation={id:null},tabris.on("flush",this.flush,this)},tabris.NativeBridge.prototype={create:function(a,b){var c={};this._operations.push(["create",a,b,c]),this._currentOperation={id:a,properties:c}},set:function(a,b,c){if(this._currentOperation.id===a)this._currentOperation.properties[b]=c;else{var d={};d[b]=c,this._operations.push(["set",a,d]),this._currentOperation={id:a,properties:d}}},listen:function(a,b,c){this._operations.push(["listen",a,b,c]),this._currentOperation={id:null}},destroy:function(a){this._operations.push(["destroy",a]),this._currentOperation={id:null}},get:function(a,b){return this.flush(),this._bridge.get(a,b)},call:function(a,b,c){return this.flush(),this._bridge.call(a,b,c)},flush:function(){tabris.trigger("beforeFlush");var a=this._operations;this._operations=[],this._currentOperation={id:null};for(var b=a.length,c=0;b>c;c++){var d=a[c];switch(d[0]){case"create":this._bridge.create(d[1],d[2],d[3]);break;case"set":this._bridge.set(d[1],d[2]);break;case"listen":this._bridge.listen(d[1],d[2],d[3]);break;case"destroy":this._bridge.destroy(d[1])}}}}}(),tabris.Events={on:function(a,b,c){this._checkDisposed();var d=this._isListening(a);return this._callbacks||(this._callbacks=[]),this._callbacks[a]=(this._callbacks[a]||[]).concat([{fn:b,ctx:c}]),d||this._listen(a,!0),this},off:function(a,b,c){if(this._checkDisposed(),this._callbacks)if(a){if(a in this._callbacks)if(b){for(var d=this._callbacks[a].concat(),e=d.length-1;e>=0;e--)d[e].fn!==b&&d[e].fn._callback!==b||c&&d[e].ctx!==c||d.splice(e,1);0===d.length?(delete this._callbacks[a],0===Object.keys(this._callbacks).length&&delete this._callbacks):this._callbacks[a]=d}else delete this._callbacks[a]}else delete this._callbacks;return this._isListening(a)||this._listen(a,!1),this},once:function(a,b,c){this._checkDisposed();var d=this,e=function(){d.off(a,e,c),b.apply(this,arguments)};return e._callback=b,this.on(a,e,c)},trigger:function(a){if(this._checkDisposed(),this._callbacks&&a in this._callbacks)for(var b=this._callbacks[a],c=Array.prototype.slice.call(arguments,1),d=0;d<b.length;d++){var e=b[d];e.fn.apply(e.ctx||this,c)}return this},_isListening:function(a){return!!this._callbacks&&(!a||a in this._callbacks)},_checkDisposed:function(){},_listen:function(){}},a.extend(tabris,tabris.Events),function(){function b(a,b,f,h){return"number"==typeof a?a:Array.isArray(a)?c(a,b,f,h):e(a)?[parseInt(a),0]:g[b]?d(a,f,h):[d(a,f,h),0]}function c(a,b,c,f){return"number"==typeof a[0]?(console.warn("Deprecated layoutData syntax: Percentage must be a string"),a.concat()):e(a[0])?[parseInt(a[0]),a[1]]:[d(a[0],c,f),a[1]]}function d(a,b,c){if("string"==typeof a){var d=b.children(a)[0];if(!d&&!c)throw new Error;return tabris.PropertyEncoding.proxy(d)||0}return tabris.PropertyEncoding.proxy(a)||0}function e(a){return"string"==typeof a&&"%"===a[a.length-1]&&!isNaN(parseInt(a))}tabris.Layout={checkLayoutData:function(b){if("centerX"in b){if("left"in b||"right"in b)return console.warn("Inconsistent layoutData: centerX overrides left and right"),a.omit(b,["left","right"])}else"left"in b||"right"in b||console.warn("Incomplete layoutData: either left, right or centerX should be specified");if("baseline"in b){if("top"in b||"bottom"in b||"centerY"in b)return console.warn("Inconsistent layoutData: baseline overrides top, bottom, and centerY"),a.omit(b,["top","bottom","centerY"])}else if("centerY"in b){if("top"in b||"bottom"in b)return console.warn("Inconsistent layoutData: centerY overrides top and bottom"),a.omit(b,["top","bottom"])}else"top"in b||"bottom"in b||console.warn("Incomplete layoutData: either top, bottom, centerY, or baseline should be specified");return b},encodeLayoutData:function(a,c,d){if(!c)return a;var e={},g=c.parent()||f;for(var h in a)e[h]=b(a[h],h,g,d);return e}};var f={children:function(){return[]}},g={centerX:!0,centerY:!0,baseline:!0}}(),tabris.Properties={set:function(a,b){return this._checkDisposed(),"string"==typeof a?this._setProperty(a,b):this._setProperties(a),this},get:function(a){return this._checkDisposed(),this._props&&a in this._props?this._props[a]:this._readProperty(a)},_setProperties:function(a){for(var b in a)this._setProperty(b,a[b])},_setProperty:function(a,b){var c=this._applyProperty(a,b);c&&(this._props||(this._props={}),this._props[a]=b)},_checkDisposed:function(){},_applyProperty:function(){return!0},_readProperty:function(){return void 0}},function(){function b(){return"o"+c++}tabris.Proxy=function(a){this.cid=a||b(),tabris._proxies[this.cid]=this},a.extend(tabris.Proxy.prototype,tabris.Events,tabris.Properties,{_create:function(a){var b=this.constructor._type||this.type;if(tabris._nativeBridge.create(this.cid,b),this.constructor&&this.constructor._initProperties)for(var c in this.constructor._initProperties)this._nativeSet(c,this.constructor._initProperties[c]);return this._setProperties(a||{}),this},dispose:function(){this._isDisposed||(this._destroy(),tabris._nativeBridge.destroy(this.cid),this._parent&&this._parent._removeChild(this),this._isDisposed=!0)},_listen:function(a,b){var c=this.constructor&&this.constructor._events&&this.constructor._events[a];c&&(c.listen?c.listen.call(this,b):this._nativeListen(c.name,b))},_nativeListen:function(a,b){tabris._nativeBridge.listen(this.cid,a,b)},_trigger:function(a,b){var c=this.constructor&&this.constructor._trigger&&this.constructor._trigger[a],d=c&&this.constructor._events[c].trigger;d instanceof Function?d.call(this,b):c?this.trigger(c,b):this.trigger(a,b)},_destroy:function(){this.trigger("dispose",{}),this._destroyChildren(),tabris.Events.off.call(this),delete tabris._proxies[this.cid]},_destroyChildren:function(){},_checkDisposed:function(){if(this._isDisposed)throw new Error("Object is disposed")},_applyProperty:function(a,b){var c=this._getPropertyType(a);if(!c)return!0;var d;try{d=this._encodeProperty(b,c,a)}catch(e){return console.warn(this.type+': Ignored unsupported value for property "'+a+'": '+e.message),!1}var f=this._getPropertySetter(a);f instanceof Function?f.call(this,d):this._nativeSet(a,tabris.PropertyEncoding.proxy(d))},_encodeProperty:function(a,b){if("string"==typeof b&&tabris.PropertyEncoding[b])return tabris.PropertyEncoding[b](a);if(Array.isArray(b)&&tabris.PropertyEncoding[b[0]]){var c=[a].concat(b.slice(1));return tabris.PropertyEncoding[b[0]].apply(window,c)}return a},_decodeProperty:function(a,b){if("string"==typeof b&&tabris.PropertyDecoding[b])return tabris.PropertyDecoding[b](a);if(Array.isArray(b)&&tabris.PropertyDecoding[b[0]]){var c=[a].concat(b.slice(1));return tabris.PropertyDecoding[b[0]].apply(window,c)}return a},_getPropertyType:function(a){var b=this.constructor&&this.constructor._properties&&this.constructor._properties[a];return"object"==typeof b&&b.type?b.type:b},_getPropertySetter:function(a){var b=this.constructor&&this.constructor._properties&&this.constructor._properties[a];return"object"==typeof b&&b.set?b.set:null},_nativeSet:function(a,b){tabris._nativeBridge.set(this.cid,a,b)},_readProperty:function(a){var b=this._getPropertyType(a);if(b){var c=this._getPropertyGetter(a),d=c?c.call(this):this._nativeGet(a);return this._decodeProperty(d,b)}},_getPropertyGetter:function(a){var b=this.constructor&&this.constructor._properties&&this.constructor._properties[a];return"object"==typeof b&&b.get?b.get:null},_nativeGet:function(a){return tabris._nativeBridge.get(this.cid,a)},_nativeCall:function(a,b){return this._checkDisposed(),tabris._nativeBridge.call(this.cid,a,b)}});var c=1}(),function(){function a(a,d,e){if(!a||0===a.length)return[];if(!d)return a.concat();var f=c(d);return e?b([],a,f):a.filter(f)}function b(a,c,d){for(var e=0;e<c.length;e++)d(c[e])&&a.push(c[e]),c[e]._children&&b(a,c[e]._children,d);return a}function c(a){var b={},c=a instanceof Function?a:d(a);return function(a){return b[a.cid]?!1:c(a)?(b[a.cid]=!0,!0):!1}}function d(a){if("#"===a.charAt(0)){var b=a.slice(1);return function(a){return b===a.id}}return"*"===a?function(){return!0}:function(b){return a===b.type}}tabris.ProxyCollection=function(b,c,d){this._array=a(b,c,d);for(var e=0;e<this._array.length;e++)this[e]=this._array[e];this.length=this._array.length};var e=tabris.ProxyCollection.prototype={first:function(){return this._array[0]},last:function(){return this._array[this._array.length-1]},toArray:function(){return this._array.concat()},forEach:function(a){var b=this;this._array.forEach(function(c,d){a(c,d,b)})},indexOf:function(a){return this._array.indexOf(a)},filter:function(a){return new tabris.ProxyCollection(this._array,a)},get:function(a){return this._array[0]?this._array[0].get(a):void 0},parent:function(){for(var a=[],b=0;b<this._array.length;b++){var c=this._array[b].parent();c&&-1===a.indexOf(c)&&a.push(c)}return a.length?new tabris.ProxyCollection(a):void 0},children:function(a){for(var b=[],c=0;c<this._array.length;c++)b.push.apply(b,this._array[c]._children||[]);return new tabris.ProxyCollection(b,a)},find:function(a){return new tabris.ProxyCollection(this.children()._array,a,!0)},appendTo:function(a){a.append(this)},dispose:function(){for(var a=0;a<this._array.length;a++)this._array[a].dispose()}};["set","animate","on","off"].forEach(function(a){e[a]=function(){for(var b=0;b<this._array.length;b++)this._array[b][a].apply(this._array[b],arguments);return this}})}(),function(){tabris.PropertyDecoding={color:function(b){return a.colorArrayToString(b)},font:function(b){return a.fontArrayToString(b)},image:function(b){return a.imageFromArray(b)},bounds:function(a){return{left:a[0],top:a[1],width:a[2],height:a[3]}}}}(),function(){function b(a){return"number"==typeof a&&!isNaN(a)&&a>=0&&1/0!==a}function c(a,b){var c=['Accepting "'];throw c.push(a.join('", "')),c.push('", given was: "',b+'"'),new Error(c.join(""))}tabris.PropertyEncoding={"boolean":function(a){return!!a},string:function(a){return""+a},natural:function(a){if("number"!=typeof a)throw new Error(typeof a+" is not a number: "+a);if(isNaN(a)||1/0===a||a===-1/0)throw new Error("Number is not a valid value: "+a);return 0>a?0:Math.round(a)},integer:function(a){if("number"!=typeof a)throw new Error(typeof a+" is not a number: "+a);if(isNaN(a)||1/0===a||a===-1/0)throw new Error("Number is not a valid value: "+a);return Math.round(a)},choice:function(a,b){return Array.isArray(b)?(-1===b.indexOf(a)&&c(b,a),a):(a in b||c(Object.keys(b),a),b[a])},color:function(b){return"initial"===b?null:a.colorStringToArray(b)},font:function(b){return"initial"===b?null:a.fontStringToArray(b)},image:function(c){if("string"==typeof c&&(c={src:c}),!c||"object"!=typeof c)throw new Error("Not an image: "+c);if("string"!=typeof c.src)throw new Error("image.src is not a string");if(""===c.src)throw new Error("image.src is an empty string");return["scale","width","height"].forEach(function(a){if(a in c&&!b(c[a]))throw new Error("image."+a+" is not a dimension: "+c[a])}),"scale"in c&&("width"in c||"height"in c)&&console.warn("Image scale is ignored if width or height are given"),a.imageToArray(c)},layoutData:function(a){return tabris.Layout.checkLayoutData(a)},bounds:function(a){return[a.left,a.top,a.width,a.height]},proxy:function(a){return a instanceof tabris.Proxy?a.cid:a instanceof tabris.ProxyCollection?a[0]?a[0].cid:null:a},nullable:function(a,b){return null===a?a:tabris.PropertyEncoding[b](a)}}}(),function(){tabris.registerType("_Animation",{_type:"tabris.Animation",_events:{completion:"Completion",progress:"Progress",start:"Start"},_properties:{properties:!0,delay:!0,duration:!0,repeat:!0,reverse:!0,easing:!0,target:"proxy"}}),tabris.Animation=function(a,d,e){var f={},g={};for(var h in e)b[h]?f[h]=e[h]:console.warn('Invalid animation option "'+h+'"');for(var i in d)c[i]?g[i]=d[i]:console.warn('Invalid animation property "'+i+'"');this._target=a,this._properties=g,this._options=f},a.extend(tabris.Animation.prototype,tabris.Events,{_start:function(){var b=this;this._proxy=tabris.create("_Animation",a.extend(this._options,{target:this._target,properties:this._properties})),this._proxy._listen("completion",!0);var b=this;this._proxy.trigger=function(){b.trigger.apply(b,arguments),"completion"===arguments[0]&&(this.dispose(),delete b._proxy)},this._proxy._nativeCall("start")},cancel:function(){this._proxy&&this._proxy._nativeCall("cancel")},_listen:function(a){"completion"!==a&&this._proxy&&this._proxy._listen.apply(this._proxy,arguments)}}),tabris.Animation.animate=function(a,b){var c=new tabris.Animation(this,a,b);return c._start(),c};var b={delay:!0,duration:!0,repeat:!0,reverse:!0,easing:!0},c={opacity:!0,transform:!0}}(),function(){function b(){try{c.call(this),tabris.off("beforeFlush",b,this),delete this._layoutDataPending,delete this._hasPreliminaryLayout}catch(a){this._hasPreliminaryLayout||(c.call(this,!0),this._hasPreliminaryLayout=!0)}}function c(a){this._layoutData?this._nativeSet("layoutData",tabris.Layout.encodeLayoutData(this._layoutData,this,a)):this._nativeSet("layoutData",null)}tabris.Widgets={append:function(){this._checkDisposed();for(var a=arguments[0]instanceof tabris.ProxyCollection?arguments[0].toArray():arguments,b=0;b<a.length;b++){if(!(a[b]instanceof tabris.Proxy))throw new Error("Cannot append non-widget");a[b]._setParent(this)}return this},appendTo:function(a){if(this._checkDisposed(),a=a instanceof tabris.ProxyCollection?a.first():a,!(a instanceof tabris.Proxy))throw new Error("Cannot append to non-widget");return this._setParent(a),this},parent:function(){return this._parent},children:function(a){return new tabris.ProxyCollection(this._children,a)},find:function(a){return new tabris.ProxyCollection(this._children,a,!0)},apply:function(a){var b=new tabris.ProxyCollection(this._children.concat(this),"*",!0);a["*"]&&b.set(a["*"]);var c;for(c in a)"*"!==c&&"#"!==c[0]&&b.filter(c).set(a[c]);for(c in a)"#"===c[0]&&b.filter(c).set(a[c]);return this},_getContainer:function(){return this},_setParent:function(a){tabris._nativeBridge.set(this.cid,"parent",tabris.PropertyEncoding.proxy(a._getContainer())),this._parent&&this._parent._removeChild(this),this._parent=a,this._parent._addChild(this)},_addChild:function(a){var b=this.constructor&&this.constructor._supportsChildren;if(b===!1)throw new Error(this.type+" cannot contain children");if("function"==typeof b&&!b(a))throw new Error(this.type+" cannot contain children of type "+a.type);this._children||(this._children=[]),this._children.push(a),this.trigger("addchild",a,this,{})},_removeChild:function(a){if(this._children){var b=this._children.indexOf(a);-1!==b&&this._children.splice(b,1),this.trigger("removechild",a,this,{index:b})}},_destroyChildren:function(){if(this._children)for(var a=0;a<this._children.length;a++)this._children[a]._destroy()}},tabris.registerWidget=function(b,c){if(c=a.extend({},tabris.Widgets,tabris.Animation,c),c._events=a.extend({},tabris.registerWidget._defaultEvents,c._events||{}),c._properties!==!0){var d=tabris.registerWidget._defaultProperties;c._properties=a.extend({},d,c._properties||{})}tabris.registerType(b,c)};var d;tabris.load(function(){d="Android"===tabris.device.get("platform")&&tabris.device.get("version")<=17}),a.extend(tabris.registerWidget,{_defaultEvents:{touchstart:!0,touchmove:!0,touchend:!0,touchcancel:!0,longpress:!0,dispose:function(){},"change:bounds":{name:"Resize",trigger:function(a){if(d){var b=this;setTimeout(function(){b.trigger("change:bounds",a)},0)}else this.trigger("change:bounds",a)}}},_defaultProperties:{enabled:"boolean",visible:{type:"boolean",set:function(a){this._nativeSet("visibility",a)},get:function(){return this._nativeGet("visibility")}},layoutData:{type:"layoutData",set:function(a){this._layoutData=a;try{c.call(this)}catch(d){this._layoutDataPending||(tabris.on("beforeFlush",b,this),this._layoutDataPending=!0)}},get:function(){return this._layoutData||null}},font:"font",backgroundImage:"image",bounds:"bounds",background:"color",foreground:"color",opacity:!0,transform:!0,highlightOnTouch:"boolean",id:{type:"string",set:function(a){this.id=a},get:function(){return this.id}}}}),tabris.registerWidget("Button",{_type:"rwt.widgets.Button",_initProperties:{style:["PUSH"]},_events:{selection:"Selection"},_properties:{alignment:["choice",["left","right","center"]],image:"image",text:"string"}}),tabris.registerWidget("Canvas",{_type:"rwt.widgets.Canvas",_supportsChildren:!0}),tabris.registerWidget("CheckBox",{_type:"rwt.widgets.Button",_initProperties:{style:["CHECK"]},_events:{"change:selection":"Selection"},_properties:{text:"string",selection:"boolean"}}),tabris.registerWidget("Picker",{_type:"rwt.widgets.Combo",_events:{"change:selection":"Selection"},_properties:{items:!0,text:"string",selectionIndex:"natural"}}),tabris.Combo=tabris.Picker,tabris.registerWidget("Composite",{_type:"rwt.widgets.Composite",_supportsChildren:!0}),tabris.registerWidget("ImageView",{_type:"tabris.ImageView",_properties:{image:"image",scaleMode:["choice",["auto","fit","fill","stretch","none"]]}}),tabris.registerWidget("TextView",{_type:"tabris.TextView",_properties:{alignment:["choice",["left","right","center"]],markupEnabled:"boolean",maxLines:{type:["nullable","natural"],set:function(a){this._nativeSet("maxLines",0>=a?null:a)}},text:"string"}}),tabris.Label=tabris.TextView,tabris.registerWidget("ProgressBar",{_type:"rwt.widgets.ProgressBar",_properties:{minimum:"integer",maximum:"integer",selection:"integer",state:["choice",["normal","paused","error"]]}}),tabris.registerWidget("RadioButton",{_type:"rwt.widgets.Button",_initProperties:{style:["RADIO"]},_events:{"change:selection":"Selection"},_properties:{text:"string",selection:"boolean"}}),tabris.registerWidget("Slider",{_type:"rwt.widgets.Scale",_events:{"change:selection":"Selection"},_properties:{minimum:"integer",maximum:"integer",selection:"integer"}}),tabris.registerWidget("TextInput",{_type:"tabris.TextInput",_events:{focus:!0,blur:!0,accept:!0,"change:text":"modify"},_properties:{type:["choice",["default","password","search","multiline"]],text:"string",message:"string",editable:"boolean",alignment:["choice",["left","center","right"]],autoCorrect:"boolean",autoCapitalize:"boolean",keyboard:["choice",["ascii","decimal","email","number","numbersAndPunctuation","phone","url","default"]]}}),tabris.Text=tabris.TextInput,tabris.registerWidget("ToggleButton",{_type:"rwt.widgets.Button",_initProperties:{style:["TOGGLE"]},_events:{"change:selection":"Selection"},_properties:{text:"string",image:"image",selection:"boolean",alignment:["choice",["left","right","center"]]}}),tabris.registerWidget("Video",{_type:"tabris.widgets.Video",_initProperties:{controls_visible:!0,repeat:!1},_properties:{url:!0}}),tabris.registerWidget("WebView",{_type:"rwt.widgets.Browser",_events:{load:"Progress"},_properties:{url:!0,html:"string"}})}(),function(){var a=function(){};tabris.DOMEvent=function(a,b){this.type=a,this.timeStamp=Date.now(),"undefined"!=typeof b&&("bubbles"in b&&(this.bubbles=b.bubbles),"cancelable"in b&&(this.cancelable=b.cancelable))},tabris.DOMEvent.prototype={NONE:0,CAPTURING_PHASE:1,AT_TARGET:2,BUBBLING_PHASE:3,target:null,currentTarget:null,eventPhase:0,type:"",bubbles:!1,cancelable:!1,defaultPrevented:!1,isTrusted:!1,stopPropagation:a,stopImmediatePropagation:a,preventDefault:a,initEvent:function(a,b,c){this.type=a,this.bubbles=b,this.cancelable=c}},tabris._addDOMEventTargetMethods=function(a){if("function"!=typeof a.addEventListener){var b;a.addEventListener=function(a,c){b||(b=[]),a in b||(b[a]=[]);var d=b[a].indexOf(c);return-1===d&&b[a].push(c),1===b[a].length},a.removeEventListener=function(a,c){if(b&&a in b){var d=b[a].indexOf(c);if(-1!==d)return b[a].splice(d,1),0===b[a].length}return!1},a.dispatchEvent=function(a){if(b&&a.type in b)for(var c=b[a.type],d=0;d<c.length;d++)c[d].call(this,a)}}},"undefined"!=typeof window&&(tabris._addDOMEventTargetMethods(window),window.Event||(window.Event=tabris.DOMEvent))}(),function(){function a(a,b){if("HEAD"===a.tagName&&"SCRIPT"===b.tagName&&b.src){var c;try{c=tabris._client.loadAndExecute(b.src,"","")}catch(d){return console.error("Error loading "+b.src+": "+d),console.log(d.stack),void("function"==typeof b.onerror&&b.onerror.call(window,d))}c.loadError?"function"==typeof b.onerror&&b.onerror.call(window,new Error("Could not load "+b.src)):"function"==typeof b.onload&&b.onload.call(window)}}var b=function(){},c=function(a){this.tagName=(a||"").toUpperCase(),this.children=[]};c.prototype={setAttribute:b,appendChild:function(b){return this.children.push(b),a(this,b),b},cloneNode:function(){return new c},lastChild:function(){return new c}},tabris._addDOMDocument=function(a){a.document={documentElement:{},createDocumentFragment:function(){return new c},createElement:function(a){return new c(a)},location:{href:""},readyState:"loading",head:new c("head"),getElementsByTagName:function(a){return this.head.children.filter(function(b){return b.tagName===a.toUpperCase()})},createEvent:function(){return new tabris.DOMEvent}},tabris._addDOMEventTargetMethods(a.document),"undefined"==typeof a.location&&(a.location=a.document.location),tabris.load(function(){a.document.readyState="complete";var b=document.createEvent("Events");b.initEvent("DOMContentLoaded",!1,!1),a.document.dispatchEvent(b)}),a.navigator={userAgent:"tabris-js"}},"undefined"==typeof window||window.document||tabris._addDOMDocument(window)}(),function(){tabris.registerType("_Timer",{_type:"tabris.Timer",_events:{Run:!0},_properties:{delay:!0,repeat:!0}}),tabris._addWindowTimerMethods=function(a){function b(a,b,e){var f=c++;return tabris.load(function(){var c=tabris.create("_Timer",{delay:b,repeat:e}).on("Run",function(){a.call(),e||(c.dispose(),delete d[f])});c._nativeCall("start"),d[f]=c}),f}if("function"!=typeof a.setTimeout){var c=0,d={};a.setTimeout=function(a,c){return b(a,c,!1)},a.setInterval=function(a,c){return b(a,c,!0)},a.clearTimeout=a.clearInterval=function(a){var b=d[a];b&&(b._nativeCall("cancel",{}),b.dispose(),delete d[a])}}},"undefined"!=typeof window&&tabris._addWindowTimerMethods(window)}(),function(){function a(){var a={};return["model","platform","version"].forEach(function(b){c(a,b,d(b))}),a}function b(){var a={};return c(a,"width",d("screenWidth")),c(a,"height",d("screenHeight")),a}function c(a,b,c){Object.defineProperty(a,b,{get:c,set:function(){}})}function d(a){return function(){return tabris.device.get(a)}}function e(a){return function(){return a}}tabris.registerType("_Device",{_type:"tabris.Device",_properties:{model:!0,platform:!0,version:!0,language:!0,orientation:!0,screenWidth:!0,screenHeight:!0,scaleFactor:!0},_setProperty:function(){},_events:{"change:orientation":{name:"orientationchange",trigger:function(a){this.trigger("change:orientation",{value:a.orientation})}}},dispose:function(){throw new Error("cannot dispose device object")}}),tabris._publishDeviceProperties=function(f){"device"in f||c(f,"device",e(a())),"screen"in f||c(f,"screen",e(b())),"navigator"in f&&!("language"in f.navigator)&&c(f.navigator,"language",d("language")),"devicePixelRatio"in f||c(f,"devicePixelRatio",d("scaleFactor"))},tabris.device=tabris("_Device"),"undefined"!=typeof window&&tabris._publishDeviceProperties(window)}(),tabris.registerType("_App",{_type:"tabris.App",_events:{pause:"Pause",resume:"Resume"},dispose:function(){throw new Error("tabris.app can not be disposed")}}),tabris.app=tabris("_App"),tabris.registerType("_Display",{_type:"rwt.widgets.Display"}),tabris.registerWidget("_Shell",{_type:"rwt.widgets.Shell",_events:{Close:!0},_properties:{style:!0,mode:!0,active:!0}}),tabris.registerType("_UI",{_type:"tabris.UI",_events:{ShowPage:!0,ShowPreviousPage:!0},_create:function(){return tabris.create("_Display"),this._shell=tabris.create("_Shell",{style:["NO_TRIM"],mode:"maximized",active:!0,visible:!0}).on("Close",function(){this.dispose()}),tabris.Proxy.prototype._create.call(this,{}),this._nativeSet("shell",this._shell.cid),this._pages=[],this.on("ShowPage",function(a){var b=tabris._proxies[a.pageId];this._setActivePage(b.widget)}).on("ShowPreviousPage",function(){var a=this._getActivePage();a&&a.close()}),this},_properties:{image:"image",foreground:"color",background:"color",activePage:{set:function(a){this._setActivePage(a)},get:function(){return this._getActivePage()}}},_setActivePage:function(a){if(!(a instanceof tabris.Page))return void console.warn("Value for activePage is not a page");var b=this._getActivePage();a!==b&&(a.on("dispose",this._pageClosed.bind(this,a)),this._pages.push(a),this._updateActivePage(b,a))},_getActivePage:function(){return this._pages[this._pages.length-1]},_pageClosed:function(a){var b=this._getActivePage();this._pages=this._pages.filter(function(b){return b!==a});var c=this._getActivePage();c!==b&&this._updateActivePage(b,this._getActivePage())},_updateActivePage:function(a,b){a&&a.trigger("disappear"),this._nativeSet("activePage",b._page.cid),b.trigger("appear")}}),tabris.load(function(){tabris.ui=tabris.create("_UI")}),function(){tabris.registerWidget("CollectionView",{_type:"tabris.CollectionView",_properties:{itemHeight:"natural",items:{set:function(a){this._setItems(a)},get:function(){return this._items.concat()}},initializeCell:{set:function(a){this._initializeCell=a}},refreshEnabled:"boolean",refreshIndicator:"boolean",refreshMessage:"string"},_create:function(){this._items=[];var a=tabris.Proxy.prototype._create.apply(this,arguments);return this._nativeListen("createitem",!0),this._nativeListen("populateitem",!0),this._reload(),a},set:function(){var a=tabris.Proxy.prototype.set.apply(this,arguments);return this._reload(),a},_events:{refresh:!0,createitem:{trigger:function(){var a=tabris.create("_CollectionCell",{});this._nativeCall("addItem",{widget:a.cid}),"function"!=typeof this._initializeCell?console.warn("initializeCell callback missing"):this._initializeCell(a)}},populateitem:{trigger:function(a){var b=tabris(a.widget),c=this._getItem(this._items,a.index);b.trigger("itemchange",c,a.index)}},selection:{trigger:function(a){this.trigger("selection",{index:a.index,item:this._getItem(this._items,a.index)})}}},_setItems:function(a){this._items=a?a.concat():[],this._needsReload=!0},_getItem:function(a,b){return a[b]},reveal:function(a){a=this._checkIndex(a),a>=0&&a<this._items.length&&this._nativeCall("reveal",{index:a})},refresh:function(a){return 0===arguments.length?void this._nativeCall("update",{reload:[0,this._items.length]}):(a=this._checkIndex(a),void(a>=0&&a<this._items.length&&this._nativeCall("update",{reload:[a,1]})))
},insert:function(a,b){if(!Array.isArray(a))throw new Error("items is not an array");b=1===arguments.length?this._items.length:Math.max(0,Math.min(this._items.length,this._checkIndex(b))),Array.prototype.splice.apply(this._items,[b,0].concat(a)),this._nativeCall("update",{insert:[b,a.length]})},remove:function(a,b){if(a=this._checkIndex(a),1===arguments.length)b=1;else{if(!("number"==typeof b&&isFinite(b)&&b>=0))throw new Error("illegal remove count");b=Math.min(b,this._items.length-a)}a>=0&&a<this._items.length&&b>0&&(this._items.splice(a,b),this._nativeCall("update",{remove:[a,b]}))},_reload:function(){this._needsReload&&(this._nativeCall("reload",{items:this._items.length}),delete this._needsReload)},_checkIndex:function(a){if("number"!=typeof a||!isFinite(a))throw new Error("illegal index");return 0>a?a+this._items.length:a}}),tabris.registerWidget("_CollectionCell",{_type:"rwt.widgets.Composite",_supportsChildren:!0,dispose:function(){console.warn("CollectionView cells are container-managed, they cannot be disposed of")}})}(),tabris.registerWidget("_ScrollBar",{_type:"rwt.widgets.ScrollBar",_events:{Selection:!0},_properties:{style:!0}}),tabris.registerWidget("ScrollComposite",{_type:"rwt.widgets.ScrolledComposite",_supportsChildren:!0,_events:{scroll:{listen:function(a){a?this._scrollBar.on("Selection",this._scrollBarListener,this):this._scrollBar.off("Selection",this._scrollBarListener,this)}}},_create:function(b){var c=a.omit(b,["direction"]);this["super"]("_create",c);var d="horizontal"===b.direction?["H_SCROLL"]:["V_SCROLL"];return this._nativeSet("style",d),this._scrollBar=tabris.create("_ScrollBar",{style:"horizontal"===b.direction?["HORIZONTAL"]:["VERTICAL"]}),tabris._nativeBridge.set(this._scrollBar.cid,"parent",this.cid),this._composite=tabris.create("Composite"),tabris._nativeBridge.set(this._composite.cid,"parent",this.cid),this._nativeSet("content",this._composite.cid),this},_scrollBarListener:function(){var a=this._nativeGet("origin");this.trigger("scroll",{x:a[0],y:a[1]})},_getContainer:function(){return this._composite}}),function(){var b=["title","image","style","topLevel"];tabris.registerWidget("_Page",{_type:"tabris.Page",_properties:{image:"image",title:"string",topLevel:"boolean",control:"proxy",parent:"proxy",style:!0}}),tabris.registerWidget("Page",{_type:"rwt.widgets.Composite",_supportsChildren:!0,_properties:{image:!0,title:!0,topLevel:!0},_create:function(c){return this["super"]("_create",a.extend(a.omit(c,b),{layoutData:{left:0,right:0,top:0,bottom:0}})),this._nativeSet("parent",tabris.ui._shell.cid),this._page=tabris.create("_Page",a.extend(a.pick(c,b),{parent:tabris.ui,control:this})),this._page.widget=this,this},dispose:function(){this._page.dispose(),this["super"]("dispose")},open:function(){return tabris.ui.set("activePage",this),this},close:function(){this.dispose()}}),b.forEach(function(a){var b=tabris.Page._properties[a];tabris.Page._properties[a]={type:b,set:function(b){this._page.set(a,b)},get:function(){return this._page.get(a)}}})}(),tabris.registerType("Action",{_type:"tabris.Action",_properties:{enabled:"boolean",foreground:"color",image:"image",placementPriority:{type:["choice",{low:"LOW",high:"HIGH",normal:"NORMAL"}],get:function(){var a=this._nativeGet("placementPriority");return a?a.toLowerCase():a}},title:"string",visible:{type:"boolean",set:function(a){this._nativeSet("visibility",a)},get:function(){return this._nativeGet("visibility")}}},_events:{selection:"Selection"},_create:function(a){return this["super"]("_create",a),this._nativeSet("parent",tabris.ui.cid),this}}),tabris.registerType("SearchAction",{_type:"tabris.SearchAction",_properties:{enabled:"boolean",foreground:"color",image:"image",placementPriority:{type:["choice",{low:"LOW",high:"HIGH",normal:"NORMAL"}],get:function(){var a=this._nativeGet("placementPriority");return a?a.toLowerCase():a}},title:"string",visible:{type:"boolean",set:function(a){this._nativeSet("visibility",a)},get:function(){return this._nativeGet("visibility")}},proposals:!0},_events:{selection:"Selection",modify:"Modify",submit:"Search"},_create:function(a){return this["super"]("_create",a),this._nativeSet("parent",tabris.ui.cid),this}}),function(){function b(a){return-1!==["title","image","badge"].indexOf(a)}function c(a){return"title"===a?"text":a}function d(a){return a instanceof tabris.Tab}function e(a){return!d(a)}tabris.registerWidget("_TabItem",{_type:"rwt.widgets.TabItem",_properties:{text:!0,image:!0,badge:!0,control:!0,index:!0}}),tabris.registerWidget("TabFolder",{_type:"rwt.widgets.TabFolder",_create:function(b){return this["super"]("_create",a.omit(b,"tabBarLocation")),"top"===b.tabBarLocation?this._nativeSet("style",["TOP"]):"bottom"===b.tabBarLocation&&this._nativeSet("style",["BOTTOM"]),this},_properties:{paging:{type:"boolean",set:function(a){this._paging=a,this._nativeSet("data",{paging:a})},get:function(){return!!this._paging}},selection:{set:function(a){return a instanceof tabris.Tab?a._isDisposed?void console.warn("Can not set TabFolder selection to disposed Tab"):void this._nativeSet("selection",a._tabItem.cid):void console.warn("Can not set TabFolder selection to "+a)},get:function(){var a=this._nativeGet("selection");return a?tabris(a)._tab:null}}},_supportsChildren:function(a){return"Tab"===a.type||"_TabItem"===a.type},_events:{"change:selection":"Selection"},_getItems:function(){return this._children?this._children.filter(e):new tabris.ProxyCollection},children:function(){return this._children?this._children.filter(d):new tabris.ProxyCollection}}),tabris.registerWidget("Tab",{_type:"rwt.widgets.Composite",_properties:{title:{type:"string",set:function(a){this._setItemProperty("text",a)}},image:{type:"image",set:function(a){this._setItemProperty("image",a)}},badge:{type:"string",set:function(a){this._setItemProperty("badge",a)}}},_supportsChildren:!0,_create:function(a){return this._itemProps={},this["super"]("_create",a)},_setItemProperty:function(a,b){this._tabItem?this._tabItem._setProperty(a,b):this._itemProps[a]=b},get:function(a){if(b(a)){if(this._tabItem)return this._tabItem.get(c(a));var d=this._itemProps[c(a)];return"image"===a?tabris.PropertyDecoding.image(d):d}return this["super"]("get",a)},_setParent:function(b){if(!(b instanceof tabris.TabFolder))throw new Error("Tab must be a child of TabFolder");tabris.Widgets._setParent.call(this,b),this._tabItem=tabris.create("_TabItem",a.extend({control:this.cid,index:b._getItems().length},this._itemProps)).appendTo(b),this._tabItem._tab=this},_destroy:function(){this._tabItem&&this._tabItem.dispose()}})}(),function(){function b(a){return a}function c(a){if(a in this.values)return a;throw new Error(a)}function d(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function e(){var a={};for(var b in g)a[b]=g[b].init;return a}function f(a,b){var c=g[b];Object.defineProperty(a,b,{get:function(){return c.decode(a._state[b])},set:function(d){try{a._state[b]=c.encode(d),c.addOperations(a,a._state[b])}catch(e){console.warn("Unsupported value for "+b+": "+d)}}})}tabris.registerType("_GC",{_type:"rwt.widgets.GC",_properties:{parent:!0}}),tabris.CanvasContext=function(a){this._gc=a,this._state=e(),this._savedStates=[],this._opCodes=[],this._newOpCodes=[],this._operations=[],this._ints=[],this._doubles=[],this._booleans=[],this._strings=[],this.canvas={width:0,height:0,style:{}};for(var b in g)f(this,b);tabris.on("flush",this._flush,this),a.on("dispose",function(){tabris.off("flush",this._flush,this)},this)},tabris.CanvasContext.prototype={save:function(){this._pushOperation("save"),this._savedStates.push(a.clone(this._state))},restore:function(){this._pushOperation("restore"),this._state=this._savedStates.pop()||this._state},beginPath:function(){this._pushOperation("beginPath")},closePath:function(){this._pushOperation("closePath")},lineTo:function(a,b){this._pushOperation("lineTo"),this._doubles.push(a,b)},moveTo:function(a,b){this._pushOperation("moveTo"),this._doubles.push(a,b)},bezierCurveTo:function(a,b,c,d,e,f){this._pushOperation("bezierCurveTo"),this._doubles.push(a,b,c,d,e,f)},quadraticCurveTo:function(a,b,c,d){this._pushOperation("quadraticCurveTo"),this._doubles.push(a,b,c,d)},rect:function(a,b,c,d){this._pushOperation("rect"),this._doubles.push(a,b,c,d)},arc:function(a,b,c,d,e,f){this._pushOperation("arc"),this._doubles.push(a,b,c,d,e),this._booleans.push(!!f)},scale:function(a,b){this._pushOperation("scale"),this._doubles.push(a,b)},rotate:function(a){this._pushOperation("rotate"),this._doubles.push(a)},translate:function(a,b){this._pushOperation("translate"),this._doubles.push(a,b)},transform:function(a,b,c,d,e,f){this._pushOperation("transform"),this._doubles.push(a,b,c,d,e,f)},setTransform:function(a,b,c,d,e,f){this._pushOperation("setTransform"),this._doubles.push(a,b,c,d,e,f)},clearRect:function(a,b,c,d){this._pushOperation("clearRect"),this._doubles.push(a,b,c,d)},fillRect:function(a,b,c,d){this._pushOperation("beginPath"),this._pushOperation("rect"),this._doubles.push(a,b,c,d),this.fill()},strokeRect:function(a,b,c,d){this._pushOperation("beginPath"),this._pushOperation("rect"),this._doubles.push(a,b,c,d),this.stroke()},fillText:function(a,b,c){this._pushOperation("fillText"),this._strings.push(a),this._booleans.push(!1,!1,!1),this._doubles.push(b,c)},strokeText:function(a,b,c){this._pushOperation("strokeText"),this._strings.push(a),this._booleans.push(!1,!1,!1),this._doubles.push(b,c)},fill:function(){this._pushOperation("fill")},stroke:function(){this._pushOperation("stroke")},measureText:function(a){return{width:5*a.length+5}},_init:function(a,b){this.canvas.width=a,this.canvas.height=b,this._gc._nativeCall("init",{width:a,height:b,font:[["sans-serif"],12,!1,!1],fillStyle:[0,0,0,255],strokeStyle:[0,0,0,255]})},_flush:function(){this._operations.length>0&&(this._gc._nativeCall("draw",{packedOperations:[this._newOpCodes,this._operations,this._doubles,this._booleans,this._strings,this._ints]}),this._operations=[],this._doubles=[],this._booleans=[],this._strings=[],this._ints=[],this._newOpCodes=[])},_pushOperation:function(a){this._opCodes.indexOf(a)<0&&(this._newOpCodes.push(a),this._opCodes.push(a)),this._operations.push(this._opCodes.indexOf(a))}},tabris.getContext=function(a,b,c){return a._gc||(a._gc=tabris.create("_GC",{parent:a})),a._ctx||(a._ctx="Android"===device.platform?new tabris.CanvasContext(a._gc):new tabris.LegacyCanvasContext(a._gc)),a._ctx._init(b,c),a._ctx};var g={lineWidth:{init:1,encode:function(a){if(a>0)return a;throw new Error(a)},decode:b,addOperations:function(a,b){a._pushOperation("lineWidth"),a._doubles.push(b)}},lineCap:{init:"butt",values:d(["butt","round","square"]),encode:c,decode:b,addOperations:function(a,b){a._pushOperation("lineCap"),a._strings.push(b)}},lineJoin:{init:"miter",values:d(["bevel","miter","round"]),encode:c,decode:b,addOperations:function(a,b){a._pushOperation("lineJoin"),a._strings.push(b)}},fillStyle:{init:[0,0,0,255],encode:a.colorStringToArray,decode:a.colorArrayToString,addOperations:function(a,b){a._pushOperation("fillStyle"),a._ints.push(b[0],b[1],b[2],b[3])}},strokeStyle:{init:[0,0,0,255],encode:a.colorStringToArray,decode:a.colorArrayToString,addOperations:function(a,b){a._pushOperation("strokeStyle"),a._ints.push(b[0],b[1],b[2],b[3])}},textAlign:{init:"start",values:d(["start","end","left","right","center"]),encode:c,decode:b,addOperations:function(a,b){a._pushOperation("textAlign"),a._strings.push(b)}},textBaseline:{init:"alphabetic",values:d(["top","hanging","middle","alphabetic","ideographic","bottom"]),encode:c,decode:b,addOperations:function(a,b){a._pushOperation("textBaseline"),a._strings.push(b)}}}}(),function(){function b(a){return a}function c(a){if(a in this.values)return a;throw new Error(a)}function d(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function e(){var a={};for(var b in g)a[b]=g[b].init;return a}function f(a,b){var c=g[b];Object.defineProperty(a,b,{get:function(){return c.decode(a._state[b])},set:function(d){try{a._state[b]=c.encode(d),a._operations.push([b,this._state[b]])}catch(e){console.warn("Unsupported value for "+b+": "+d)}}})}tabris.LegacyCanvasContext=function(a){this._gc=a,this._state=e(),this._savedStates=[],this._operations=[],this.canvas={width:0,height:0,style:{}};for(var b in g)f(this,b);tabris.on("flush",this._flush,this),a.on("dispose",function(){tabris.off("flush",this._flush,this)},this)},tabris.LegacyCanvasContext.prototype={save:function(){this._operations.push(["save"]),this._savedStates.push(a.clone(this._state))},restore:function(){this._operations.push(["restore"]),this._state=this._savedStates.pop()||this._state},beginPath:function(){this._operations.push(["beginPath"])},closePath:function(){this._operations.push(["closePath"])},lineTo:function(a,b){this._operations.push(["lineTo",a,b])},moveTo:function(a,b){this._operations.push(["moveTo",a,b])},bezierCurveTo:function(a,b,c,d,e,f){this._operations.push(["bezierCurveTo",a,b,c,d,e,f])},quadraticCurveTo:function(a,b,c,d){this._operations.push(["quadraticCurveTo",a,b,c,d])},rect:function(a,b,c,d){this._operations.push(["rect",a,b,c,d])},arc:function(a,b,c,d,e,f){this._operations.push(["arc",a,b,c,d,e,!!f])},scale:function(a,b){this._operations.push(["scale",a,b])},rotate:function(a){this._operations.push(["rotate",a])},translate:function(a,b){this._operations.push(["translate",a,b])},transform:function(a,b,c,d,e,f){this._operations.push(["transform",a,b,c,d,e,f])},setTransform:function(a,b,c,d,e,f){this._operations.push(["setTransform",a,b,c,d,e,f])},clearRect:function(a,b,c,d){this._operations.push(["clearRect",a,b,c,d])},fillRect:function(a,b,c,d){this._operations.push(["beginPath"],["rect",a,b,c,d]),this.fill()},strokeRect:function(a,b,c,d){this._operations.push(["beginPath"],["rect",a,b,c,d]),this.stroke()},fillText:function(a,b,c){this._operations.push(["fillText",a,!1,!1,!1,b,c])},strokeText:function(a,b,c){this._operations.push(["strokeText",a,!1,!1,!1,b,c])},fill:function(){this._operations.push(["fill"])},stroke:function(){this._operations.push(["stroke"])},measureText:function(a){return{width:5*a.length+5}},_init:function(a,b){this.canvas.width=a,this.canvas.height=b,this._gc._nativeCall("init",{width:a,height:b,font:[["sans-serif"],12,!1,!1],fillStyle:[0,0,0,255],strokeStyle:[0,0,0,255]})},_flush:function(){this._operations.length>0&&(this._gc._nativeCall("draw",{operations:this._operations}),this._operations=[])}};var g={lineWidth:{init:1,encode:function(a){if(a>0)return a;throw new Error(a)},decode:b},lineCap:{init:"butt",values:d(["butt","round","square"]),encode:c,decode:b},lineJoin:{init:"miter",values:d(["bevel","miter","round"]),encode:c,decode:b},fillStyle:{init:[0,0,0,255],encode:a.colorStringToArray,decode:a.colorArrayToString},strokeStyle:{init:[0,0,0,255],encode:a.colorStringToArray,decode:a.colorArrayToString},textAlign:{init:"start",values:d(["start","end","left","right","center"]),encode:c,decode:b},textBaseline:{init:"alphabetic",values:d(["top","hanging","middle","alphabetic","ideographic","bottom"]),encode:c,decode:b}}}(),function(){tabris.registerType("_ClientStore",{_type:"tabris.ClientStore"});var b;tabris.WebStorage=function(){b=tabris("_ClientStore")},tabris.WebStorage.prototype={setItem:function(a,c){if(!a)throw new TypeError("Key argument must be specified to execute 'setItem'");if(!c)throw new TypeError("Value argument must be specified to execute 'setItem'");"string"==typeof a&&"string"==typeof c&&b._nativeCall("add",{key:a,value:c})},getItem:function(a){return"string"==typeof a?b._nativeCall("get",{key:a}):void 0},removeItem:function(a){"string"==typeof a&&b._nativeCall("remove",{keys:[a]})},clear:function(){b._nativeCall("clear")}},tabris.StorageEvent=function(a){this.type=a},tabris.StorageEvent.prototype=a.extendPrototype(tabris.DOMEvent,{bubbles:!1,cancelable:!1,key:"",oldValue:null,newValue:null,url:"",storageArea:null}),window.Storage||(window.Storage=tabris.WebStorage,window.localStorage=new tabris.WebStorage)}(),function(){tabris.registerType("_HttpRequest",{_type:"tabris.HttpRequest",_events:{StateChange:!0,DownloadProgress:!0,UploadProgress:!0}});var b=["loadstart","readystatechange","load","loadend","progress","timeout","abort","error"],c=["progress","loadstart","load","loadend","timeout","abort","error"];tabris.XMLHttpRequest=function(){var a=d(this);f(this,a),g(this,a),h(this,a),j(this,a),i(this,a),k(this,a),n(this,a),o(this,a),p(this,a),l(this,a),e(a),this.open=q(this,a),this.send=r(this,a),this.abort=s(this,a),this.setRequestHeader=t(this,a),this.getResponseHeader=u(this,a),this.getAllResponseHeaders=v(this,a),tabris._addDOMEventTargetMethods(this),tabris._addDOMEventTargetMethods(a.uploadEventTarget)},tabris.XMLHttpRequest.prototype={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},tabris.XMLHttpRequestProgressEvent=function(a){this.type=a},tabris.XMLHttpRequestProgressEvent.prototype=a.extendPrototype(tabris.DOMEvent,{lengthComputable:!1,loaded:0,total:0});var d=function(a){var b={};return b.proxy=null,b.authorRequestHeaders={},b.uploadListeners={},b.uploadEventTarget={},b.timeout=0,b.status=0,b.statusText="",b.responseHeaders="",b.readyState=a.UNSENT,b.responseText="",b.withCredentials=!1,b.responseType="",b.sendInvoked=!1,b.isSynchronous=!1,b.error=!1,b.uploadComplete=!1,b},e=function(a){b.forEach(function(b){a["on"+b]=null}),c.forEach(function(b){a.uploadListeners["on"+b]=null})},f=function(a,b){Object.defineProperty(a,"upload",{get:function(){return b.uploadEventTarget},set:function(){}})},g=function(a,b){Object.defineProperty(a,"readyState",{get:function(){return b.readyState},set:function(){}})},h=function(a,b){Object.defineProperty(a,"timeout",{get:function(){return b.timeout},set:function(a){isNaN(a)||(b.timeout=Math.round(a))}})},i=function(a,b){Object.defineProperty(a,"responseText",{get:function(){if(null===b.responseText)return"";if("string"!=typeof b.responseText)throw new Error("IllegalStateError: responseText is not a string");return b.readyState!==a.LOADING&&b.readyState!==a.DONE?"":b.error?"":b.responseText},set:function(){}})},j=function(a,b){Object.defineProperty(a,"response",{get:function(){return b.readyState!==a.LOADING&&b.readyState!==a.DONE?"":b.error?"":b.responseText},set:function(){}})},k=function(a,b){Object.defineProperty(a,"responseType",{get:function(){return b.responseType},set:function(c){if(b.readyState===a.LOADING||b.readyState===a.DONE)throw new Error("InvalidStateError: state must not be 'LOADING' or 'DONE' when setting responseType");if(!(["arraybuffer","blob","document","json","text"].indexOf(c)<0)){if(["arraybuffer","blob","document","json"].indexOf(c)>-1)throw new Error("Only the 'text' response type is supported.");b.responseType=c}}})},l=function(a,d){b.forEach(function(b){m(b,a,d)}),c.forEach(function(a){m(a,d.uploadEventTarget,d.uploadListeners)})},m=function(a,b,c){var d="on"+a;Object.defineProperty(b,d,{get:function(){return c[d]},set:function(e){"function"==typeof e&&(b.removeEventListener(a,b[d]),c[d]=e,b.addEventListener(a,b[d]))}})},n=function(a,b){Object.defineProperty(a,"status",{get:function(){return[a.OPENED,a.UNSENT].indexOf(b.readyState)>-1?0:b.error?0:b.status},set:function(){}})},o=function(a,b){Object.defineProperty(a,"statusText",{get:function(){return[a.OPENED,a.UNSENT].indexOf(b.readyState)>-1?"":b.error?"":b.statusText},set:function(){}})},p=function(a,b){Object.defineProperty(a,"withCredentials",{set:function(c){if(b.readyState!==a.UNSENT&&b.readyState!==a.OPENED)throw new Error("InvalidStateError: state must be 'UNSENT' or 'OPENED' when setting withCredentials");if(b.sendInvoked)throw new Error("InvalidStateError: 'send' invoked, failed to set 'withCredentials'");"boolean"==typeof c&&(b.withCredentials=c)},get:function(){return b.withCredentials}})},q=function(a,b){return function(c,d,e,f,g){var h={};z(c,d),h.source=d;var i=d.replace(/.*?:\/\//g,"");if(h.isRelative=!new RegExp("^(?:[a-z]+:)?//","i").test(d),h.userdata=i.substring(0,i.indexOf("@")),"undefined"==typeof e&&(e=!0,f=null,g=null),!e)throw new Error("Only asynchronous request supported.");h.isRelative&&f&&g&&(h.userdata=f+":"+g),b.requestMethod=c,b.requestUrl=h,b.isSynchronous=!e,b.authorRequestHeaders={},b.sendInvoked=!1,b.responseText=null,b.readyState!==a.OPENED&&(b.readyState=a.OPENED,K("readystatechange",a))}},r=function(a,b){return function(c){if(b.proxy=tabris.create("_HttpRequest"),b.proxy.on("StateChange",function(c){x(c,a,b)}),b.proxy.on("DownloadProgress",function(b){F("progress",a,b.lengthComputable,b.loaded,b.total)}),b.proxy.on("UploadProgress",function(b){F("progress",a.upload,b.lengthComputable,b.loaded,b.total)}),b.readyState!==a.OPENED)throw new Error("InvalidStateError: Object's state must be 'OPENED', failed to execute 'send'");if(b.sendInvoked)throw new Error("InvalidStateError: 'send' invoked, failed to execute 'send'");["GET","HEAD"].indexOf(b.requestMethod)>-1&&(c=null),b.requestBody=c,b.error=b.uploadComplete=!1,c||(b.uploadComplete=!0),b.withCredentials&&b.requestUrl.userdata&&a.setRequestHeader("Authorization","Basic "+b.requestUrl.userdata),b.sendInvoked=!0,F("loadstart",a),b.uploadComplete||F("loadstart",a.upload),b.proxy._nativeCall("send",{url:b.requestUrl.source,method:b.requestMethod,timeout:a.timeout,headers:b.authorRequestHeaders,data:b.requestBody})}},s=function(a,b){return function(){b.proxy&&b.proxy._nativeCall("abort"),[a.UNSENT,a.OPENED].indexOf(b.readyState)>-1&&!b.sendInvoked||b.readyState===a.DONE||(K("readystatechange",a),b.uploadComplete||(b.uploadComplete=!0,G(a.upload)),G(a)),b.readyState=a.UNSENT}},t=function(a,b){return function(c,d){if(b.readyState!==a.OPENED)throw new Error("InvalidStateError: Object's state must be 'OPENED', failed to execute 'setRequestHeader'");if(b.sendInvoked)throw new Error("InvalidStateError: cannot set request header if 'send()' invoked and request not completed");if(!B(c))throw new TypeError("Invalid HTTP header name, failed to execute 'open'");if(!C(d))throw new TypeError("Invalid HTTP header value, failed to execute 'open'");if(D(c))throw new Error("Cannot set forbidden header '"+c+"'");b.authorRequestHeaders[c]=c in b.authorRequestHeaders?b.authorRequestHeaders[c]+", "+d:d}},u=function(a,b){return function(c){if([a.UNSENT,a.OPENED].indexOf(a.readyState)>-1)return null;if(b.error)return null;var d=["set-cookie","set-cookie2","status"];if(d.indexOf(c.toLowerCase())>-1)return null;for(var e in b.responseHeaders)if(e.toLowerCase()===c.toLowerCase())return b.responseHeaders[e];return null}},v=function(a,b){return function(){return[a.UNSENT,a.OPENED].indexOf(a.readyState)>-1?"":b.error?"":w(b.responseHeaders)}},w=function(a){var b=[],c=["set-cookie","set-cookie2","status"];for(var d in a)c.indexOf(d.toLowerCase())<0&&b.push(d+": "+a[d]);return b.join("\n")},x=function(a,b,c){switch(a.state){case"headers":c.readyState=b.HEADERS_RECEIVED,c.status=a.code,c.statusText=a.message,c.responseHeaders=a.headers,K("readystatechange",b),c.uploadComplete=!0,I(b.upload);break;case"loading":c.readyState=b.LOADING,K("readystatechange",b);break;case"finished":c.responseText=a.response,c.readyState=b.DONE,K("readystatechange",b),I(b),I(b.upload),c.proxy.dispose(),c.proxy=null;break;case"error":y("error",b,c);break;case"timeout":y("timeout",b,c);break;case"abort":y("abort",b,c)}},y=function(a,b,c){c.error=!0,c.readyState=b.DONE,K("readystatechange",b),H(a,b),c.uploadComplete||(c.uploadComplete=!0,H(a,b.upload)),c.proxy.dispose(),c.proxy=null},z=function(a,b){if(!a)throw new TypeError("Method argument should be specified to execute 'open'");if(!b)throw new TypeError("URL argument should be specified to execute 'open'");A(a)},A=function(a){if(!B(a))throw new TypeError("Invalid HTTP method, failed to execute 'open'");var b=["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"],c=a.toUpperCase();b.indexOf(c)>=0&&(a=c);var d=["CONNECT","TRACE","TRACK"];if(d.indexOf(a)>=0)throw new Error("SecurityError: '"+a+"' HTTP method is not secure, failed to execute 'open'")},B=function(a){var b=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"];return!(/[^\x21-\x7E]/.test(a)||b.indexOf(a)>=0)},C=function(a){return!(!/[*A-z\u00C0-\u00ff]+/g.test(a)||a.indexOf("\n")>-1||a.indexOf("\r")>-1)},D=function(a){return E.indexOf(a.toLowerCase())>-1},E=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],F=function(a,b,c,d,e){b.dispatchEvent(J(a,b,c,d,e))},G=function(a){F("progress",a),F("abort",a),F("loadend",a)},H=function(a,b){F("progress",b),F(a,b),F("loadend",b)},I=function(a){F("load",a),F("loadend",a)},J=function(a,b,c,d,e){var f=new tabris.XMLHttpRequestProgressEvent(a);return f.currentTarget=f.target=b,c&&(f.lengthComputable=c),d&&(f.loaded=d),e&&(f.total=e),f},K=function(a,b){var c=L(a,b);b.dispatchEvent(c)},L=function(a,b){var c=new tabris.DOMEvent(a);return c.currentTarget=c.target=b,c};"undefined"==typeof XMLHttpRequest&&(window.XMLHttpRequest=tabris.XMLHttpRequest,window.XMLHttpRequestProgressEvent=tabris.XMLHttpRequestProgressEvent)}()}();